{% extends 'kf_app/base.html' %}
{% load static %}

{% block content %}
    <section class="section">
        <h2 class="section-title">Новинки среди фильмов</h2>
        <div class="content-list">
            {% for movie in movies_sample %}
                <div class="content-item">
                    <a href="{% url 'kf_app:movie_detail' movie.pk %}">
                        {% if movie.poster %}
                            <img src="{{ movie.poster.url }}" alt="{{ movie.title }}" class="content-poster">
                        {% else %}
                            <img src="{% static 'kf_app/images/default_poster.jpg' %}" alt="{{ movie.title }}" class="content-poster">
                        {% endif %}
                        <h3 class="content-title">{{ movie.title }}</h3>
                        <p class="content-info">{{ movie.release_date|date:"Y" }}</p>
                    </a>
                </div>
            {% empty %}
                <p>Фильмов пока нет.</p>
            {% endfor %}
        </div>
        <div class="more-link">
            <a href="{% url 'kf_app:movies_list' %}" class="btn">Все фильмы &raquo;</a>
        </div>
    </section>

    <section class="section">
        <h2 class="section-title">Новинки среди сериалов</h2>
        <div class="content-list">
            {% for serie in series_sample %}
                <div class="content-item">
                    <a href="{% url 'kf_app:series_detail' serie.pk %}">
                        {% if serie.poster %}
                            <img src="{{ serie.poster.url }}" alt="{{ serie.title }}" class="content-poster">
                        {% else %}
                            <img src="{% static 'kf_app/images/default_poster.jpg' %}" alt="{{ serie.title }}" class="content-poster">
                        {% endif %}
                        <h3 class="content-title">{{ serie.title }}</h3>
                        <p class="content-info">{{ serie.release_date|date:"Y" }}</p>
                    </a>
                </div>
            {% empty %}
                <p>Сериалов пока нет.</p>
            {% endfor %}
        </div>
        <div class="more-link">
            <a href="{% url 'kf_app:series_list' %}" class="btn">Все сериалы &raquo;</a>
        </div>
    </section>

    <!-- Форма обратной связи ТОЛЬКО на главной -->
    <section class="section feedback-section-main">
        <h2 class="section-title">Обратная связь</h2>
        <p class="feedback-description">Есть вопросы или предложения? Напишите нам!</p>
        
        <div class="feedback-form-main">
            <form method="POST" action="{% url 'kf_app:index' %}">
                {% csrf_token %}
                <div class="form-group">
                    <input type="text" name="name" placeholder="Ваше имя" required>
                </div>
                <div class="form-group">
                    <input type="email" name="email" placeholder="Ваш email" required>
                </div>
                <div class="form-group">
                    <textarea name="message" placeholder="Ваше сообщение" rows="4" required></textarea>
                </div>
                <button type="submit" class="btn btn-primary">Отправить сообщение</button>
            </form>
        </div>
    </section>

    <!-- Модальное окно успеха -->
    {% if feedback_success %}
    <div id="successModal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-icon">✓</div>
            <h3>Сообщение отправлено!</h3>
            <p>Спасибо! Ваше сообщение было успешно отправлено.</p>
            <button onclick="closeModal()" class="btn btn-primary">OK</button>
        </div>
    </div>
    <script>
        function closeModal() {
            document.getElementById('successModal').style.display = 'none';
        }
        
        // Закрытие по клику вне модального окна
        document.getElementById('successModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
    {% endif %}
{% endblock %}